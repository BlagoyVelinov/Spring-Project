<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <head th:replace="~{fragments/commons::head}"></head>
    <link rel="stylesheet" href="/css/style-program.css"/>
</head>
<body id="page2">
<!-- START PAGE SOURCE -->
<div class="tail-top">
    <div class="tail-bottom">
        <div id="main">
            <header th:replace="~{fragments/commons::nav}"></header>
            <div id="content">
                <div class="line-hor"></div>
                <div class="box">
                    <div class="border-right">

                        <div class="border-left">
                            <div class="inner">
                                <h3 class="title">Projections <span>Today</span></h3>
                                <div class="form-row m-5">
                                    <form th:method="post"
                                          th:action="@{/program}"
                                          th:object="${createOrder}">
                                        <div class="col">
                                            <label for="dateInput"></label>
                                            <input type="date" name="dateInput"
                                                   id="dateInput"
                                                   class="form-control"
                                                   placeholder="Select a date"
                                                   th:min="*{startDate}"
                                                   th:max="*{endDate}"
                                                   th:field="*{projectionDate}">


                                            <small th:if="${#fields.hasErrors('projectionDate')}"
                                                   th:errors="*{projectionDate}" class="text-danger">
                                                Reserved date cannot be in the past</small>
                                        </div>

                                        <div class="form-group">
                                            <div class="text-white label-holder d-flex justify-content-center">
                                                <label for="cityName" class="h4"></label>
                                            </div>
                                            <select class="browser-default custom-select"
                                                    id="cityName"
                                                    type="submit"
                                                    name="cityName"
                                                    th:field="*{location}">

<!--                                                <option value="">Select City</option>-->
                                                <option value="SOFIA">Sofia</option>
                                                <option value="PLOVDIV">Plovdiv</option>
                                                <option value="STARA_ZAGORA">Stara Zagora</option>
                                                <option value="RUSE">Ruse</option>
                                                <option value="BURGAS">Burgas</option>
                                                <option value="VARNA">Varna</option>
                                            </select>


                                            <small th:if="${#fields.hasErrors('location')}"
                                                   th:errors="*{location}" class="text-danger">
                                                City Name error message</small>

                                        </div>

                                        <div class="button-holder d-flex justify-content-center">
                                            <button type="submit" class="btn btn-primary btn-lg">Continue</button>
                                        </div>

                                    </form>

                                    <th:block sec:authorize="isAuthenticated()">
                                        <div class="button-holder d-flex justify-content-center"
                                             sec:authorize="hasRole('ADMINISTRATOR')">
                                            <a th:href="@{/movies/add-movie}">
                                                <button type="submit">Add Movie</button>
                                            </a>
                                        </div>
                                    </th:block>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content">
                    <h4 id="displayDate">Choose a date and city for reserve ticket</h4><h4 id="displayName"></h4>
                    <ul th:each="movieView : ${allViewMovies}" class="list">
                        <li class="movieList"><img th:src="${movieView.imageUrl}" alt="Movie Pic" width="204px"
                                                   height="219px"/>
                            <a th:href="@{/trailer/{movieId}(movieId=${movieView.id})}" th:text="${movieView.name}"
                               class="title-movie">Name of movie</a><br/>
                            <span data-v-048a28f8="" class="qb-movie-rating-info">
                               <img th:src="${movieView.movieClass.getIcon()}"
                                    th:alt="${movieView.movieClass.description}"
                                    type="primary" height="30" tabindex="0" aria-label="Без възрастови ограничения"
                                    class="rating-icon mr-sm"><div data-v-048a28f8="" class="qb-movie-info-wrapper">
                               <div data-v-048a28f8="" class="pt-xs">
                               <span th:each="genre : ${movieView.genreCategories}" th:text="|${genre.value},|"
                                     data-v-048a28f8="" tabindex="0" class="mr-sm">
                                   Adventure, Animation, Comedy, Family
                               </span>
                               <span data-v-048a28f8="" class="ml-xs">|</span>
                               <span th:text="|${movieView.movieLength} min.|" data-v-048a28f8=""
                                     tabindex="0" class="mr-xs">101 мин.</span>
                                <div th:text="${movieView.projectionFormat.getValue()}" class="screening-type"
                                     tabindex="0"
                                     aria-label="Screening type: 2D">2D</div>
                                <div data-v-048a28f8="" tabindex="0" class="npm-quickbook">
                                    <th:block th:if="${movieView.getBookingTimes().size() == 0}">
                                        <a class="h4">Coming soon</a>
                                        </th:block>
                                    <a th:if="${movieView.getBookingTimes().size() != 0}"
                                       th:each="bookTime : ${movieView.bookingTimes}"

                                       th:href="@{/program}"
                                       class="btn btn-primary btn-lg"
                                       th:text="${bookTime.bookingTime.value}"> 12:20 </a>



                                    <th:block sec:authorize="isAuthenticated()">
                                    <a sec:authorize="hasRole('ADMINISTRATOR')"
                                       th:href="@{/program/update-projection-time/{movieId}(movieId=${movieView.id})}"
                                       class="btn btn-primary btn-lg"> Update projection time </a>

                                        <form th:method="delete"
                                              th:action="@{/movies/delete-movie/{movieId}(movieId=${movieView.id})}">
                                            <div sec:authorize="hasRole('ADMINISTRATOR')" class="button-holder d-flex justify-content-center">
                                                <button type="submit" class="btn btn-info mb-3">Delete Movie</button>
                                            </div>
                                        </form>
                                    </th:block>
                                </div>
                                <div class="qb-movie-info-column">
                                    <ul class="qb-movie-attributes"></ul>
                                        <span th:text="|(AUD:${movieView.audio}. SUB:${movieView.subtitles}.)|"
                                              tabindex="0" aria-label="dubAbbr">
                                            (DUB:Bylg. SUB:Engl)</span>
                                </div>
                                <!----></div></div></span>
                        </li>
                    </ul>
                </div>
            </div>
            <footer th:replace="~{fragments/commons::footer}"></footer>
        </div>
    </div>
</div>
<script type="text/javascript"> Cufon.now(); </script>
<!-- END PAGE SOURCE -->
</body>
</html>